<script lang="ts" setup>
import type {Drawing, Point} from '@/components/garden/GardenCanvas.vue';

interface Flower extends Drawing, Point {}

definePageMeta({
    name: 'romy.garden',
});

const CANVAS_SIZE = 200;

const flowers = ref<Array<Flower>>([
    {
        path: 'M101 52L101 48L100 46L99 46L98 45L98 44L97 43L96 43L96 42L95 41L94 41L93 40L93 39L92 39L90 37L90 36L89 36L88 35L88 36L88 35L87 35L87 34L84 34L84 33L82 33L82 34L76 34L75 35L75 36L74 37L74 39L73 39L73 41L72 42L72 62L72 59L70 57L70 56L69 55L68 53L67 52L67 53L67 51L66 50L65 48L65 47L64 47L63 46L63 45L62 44L61 44L60 42L59 41L58 41L58 40L57 40L56 39L48 39L48 40L47 40L46 41L46 42L44 44L44 46L43 47L43 48L42 50L42 63L43 64L43 66L44 66L45 67L45 68L46 68L46 69L49 72L49 74L50 74L49 74L50 74L50 75L49 75L49 73L48 73L48 72L46 72L45 71L44 71L43 70L41 70L39 69L38 69L37 68L25 68L25 69L24 69L24 70L23 70L23 71L22 72L22 73L21 73L21 75L20 75L20 86L21 86L22 87L23 89L23 90L24 90L27 93L28 93L28 94L30 94L30 95L31 95L32 96L42 96L42 97L44 97L44 98L46 98L46 99L47 99L47 101L46 101L46 102L44 102L44 103L42 103L42 104L32 104L31 105L30 105L30 106L28 106L28 107L27 107L24 110L23 110L23 111L22 113L21 114L20 114L20 125L21 125L21 127L22 127L22 128L23 129L23 130L24 130L24 131L25 131L25 132L37 132L38 131L39 131L41 130L43 130L44 129L45 129L46 128L48 128L48 127L49 127L49 125L50 125L50 126L49 126L50 126L49 126L49 128L46 131L46 132L45 132L45 133L44 134L43 134L43 136L42 137L42 150L43 152L43 153L44 154L44 156L46 158L46 159L47 160L48 160L48 161L56 161L57 160L58 160L58 159L59 159L60 158L61 156L62 156L63 155L63 154L64 153L65 153L65 152L66 150L67 149L67 147L67 148L68 147L69 145L70 144L70 143L72 141L72 138L72 158L73 159L73 161L74 161L74 163L75 164L75 165L76 166L82 166L82 167L84 167L84 166L87 166L87 165L88 165L88 164L88 165L89 164L90 164L90 163L92 161L93 161L93 160L94 159L95 159L96 158L96 157L97 157L98 156L98 155L99 154L100 154L101 152L101 148L99 148L99 152L100 154L101 154L102 155L102 156L103 157L104 157L104 158L105 159L106 159L107 160L107 161L108 161L110 163L110 164L111 164L112 165L112 164L112 165L113 165L113 166L116 166L116 167L118 167L118 166L124 166L125 165L125 164L126 163L126 161L127 161L127 159L128 158L128 138L128 141L130 143L130 144L131 145L132 147L133 148L133 147L133 149L134 150L135 152L135 153L136 153L137 154L137 155L138 156L139 156L140 158L141 159L142 159L142 160L143 160L144 161L152 161L152 160L153 160L154 159L154 158L156 156L156 154L157 153L157 152L158 150L158 137L157 136L157 134L156 134L155 133L155 132L154 132L154 131L151 128L151 126L150 126L151 126L150 126L150 125L151 125L151 127L152 127L152 128L154 128L155 129L156 129L157 130L159 130L161 131L162 131L163 132L175 132L175 131L176 131L176 130L177 130L177 129L178 128L178 127L179 127L179 125L180 125L180 114L179 114L178 113L177 111L177 110L176 110L173 107L172 107L172 106L170 106L170 105L169 105L168 104L158 104L158 103L156 103L156 102L154 102L154 101L153 101L153 99L154 99L154 98L156 98L156 97L158 97L158 96L168 96L169 95L170 95L170 94L172 94L172 93L173 93L176 90L177 90L177 89L178 87L179 86L180 86L180 75L179 75L179 73L178 73L178 72L177 71L177 70L176 70L176 69L175 69L175 68L163 68L162 69L161 69L159 70L157 70L156 71L155 71L154 72L152 72L152 73L151 73L151 75L150 75L150 74L151 74L150 74L151 74L151 72L154 69L154 68L155 68L155 67L156 66L157 66L157 64L158 63L158 50L157 48L157 47L156 46L156 44L154 42L154 41L153 40L152 40L152 39L144 39L143 40L142 40L142 41L141 41L140 42L139 44L138 44L137 45L137 46L136 47L135 47L135 48L134 50L133 51L133 53L133 52L132 53L131 55L130 56L130 57L128 59L128 62L128 42L127 41L127 39L126 39L126 37L125 36L125 35L124 34L118 34L118 33L116 33L116 34L113 34L113 35L112 35L112 36L112 35L111 36L110 36L110 37L108 39L107 39L107 40L106 41L105 41L104 42L104 43L103 43L102 44L102 45L101 46L100 46L99 48L99 52Z',
        color: '#00b7ef',
        x: 0,
        y: 0,
    },
]);

function createFlower(drawing: Drawing) {
    if (!drawing.path) {
        return;
    }

    // TODO Random placement
    flowers.value.push({
        ...drawing,
        x: flowers.value.length * (CANVAS_SIZE + 8),
        y: 0,
    });
}
</script>

<template>
    <div class="container mx-auto my-4 flex grow flex-col px-4 md:my-16">
        <div class="relative mb-4 px-12">
            <UiButtonIcon
                :to="{ name: 'romy.index' }"
                class="!absolute left-0 top-1/2 shrink-0 -translate-y-1/2"
                icon="ph:caret-left"
            />

            <h1 class="text-center">
                {{ $t('garden.title') }}
            </h1>
        </div>

        <div class="flex h-full flex-col items-center justify-center gap-8">
            <GardenCanvas
                :canvas-size="CANVAS_SIZE"
                @artwork-created="createFlower"
            />

            <div class="flex min-h-[400px] w-full flex-wrap bg-lime-400">
                <GardenFlower
                    v-for="(flower, index) in flowers"
                    :key="`flower-${index}`"
                    :canvas-size="CANVAS_SIZE"
                    :color="flower.color"
                    :petal-path="flower.path"
                    class="size-24 lg:size-32"
                />
            </div>
        </div>
    </div>
</template>
